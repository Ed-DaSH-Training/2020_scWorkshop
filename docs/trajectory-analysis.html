<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 Trajectory Analysis | ANALYSIS OF SINGLE CELL RNA-SEQ DATA</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="14 Trajectory Analysis | ANALYSIS OF SINGLE CELL RNA-SEQ DATA" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://broadinstitute.github.io/2020_scWorkshop/" />
  <meta property="og:image" content="https://broadinstitute.github.io/2020_scWorkshop/images/cover.png" />
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="broadinstitute/2019_scWorkship" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 Trajectory Analysis | ANALYSIS OF SINGLE CELL RNA-SEQ DATA" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="twitter:image" content="https://broadinstitute.github.io/2020_scWorkshop/images/cover.png" />

<meta name="author" content="Orr Ashenberg" />
<meta name="author" content="Dana Silverbush" />
<meta name="author" content="Kirk Gosik" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="trajectory-inference.html"/>
<link rel="next" href="mutli-omic-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ANALYSIS OF SINGLE CELL RNA-SEQ DATA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> COURSE OVERVIEW</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#targeted-audience-assumed-background"><i class="fa fa-check"></i><b>1.2</b> TARGETED AUDIENCE &amp; ASSUMED BACKGROUND</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#course-format"><i class="fa fa-check"></i><b>1.3</b> COURSE FORMAT</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.4</b> Getting Started</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#session-content"><i class="fa fa-check"></i><b>1.5</b> SESSION CONTENT</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#monday-classes-from-0800-to-1600-lunch-break-1-hr-40-min-of-total-coffee-breaks"><i class="fa fa-check"></i><b>1.5.1</b> Monday – Classes from 08:00 to 16:00 (lunch break-1 hr, 40 min of total coffee breaks)</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#tuesday-classes-from-0800-to-1600"><i class="fa fa-check"></i><b>1.5.2</b> Tuesday – Classes from 08:00 to 16:00</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#wednesday-classes-from-0800-to-1600"><i class="fa fa-check"></i><b>1.5.3</b> Wednesday – Classes from 08:00 to 16:00</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#thursday-classes-from-0800-to-1600"><i class="fa fa-check"></i><b>1.5.4</b> Thursday – Classes from 08:00 to 16:00</a></li>
<li class="chapter" data-level="1.5.5" data-path="index.html"><a href="index.html#friday-classes-from-0800-to-1600"><i class="fa fa-check"></i><b>1.5.5</b> Friday – Classes from 08:00 to 16:00</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-1.html"><a href="introduction-1.html#slides"><i class="fa fa-check"></i><b>2.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html"><i class="fa fa-check"></i><b>3</b> Understanding Sequencing Raw Data</a><ul>
<li class="chapter" data-level="3.1" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#class-environment"><i class="fa fa-check"></i><b>3.1</b> Class Environment</a><ul>
<li class="chapter" data-level="3.1.1" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#getting-into-aws-instance"><i class="fa fa-check"></i><b>3.1.1</b> Getting into AWS Instance</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#shell-and-unix-commands"><i class="fa fa-check"></i><b>3.2</b> Shell and Unix commands</a><ul>
<li class="chapter" data-level="3.2.1" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#common-linux-commands"><i class="fa fa-check"></i><b>3.2.1</b> Common Linux Commands</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#file-formats"><i class="fa fa-check"></i><b>3.3</b> File formats</a><ul>
<li class="chapter" data-level="3.3.1" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#view-fastq-files"><i class="fa fa-check"></i><b>3.3.1</b> View FASTQ Files</a></li>
<li class="chapter" data-level="3.3.2" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#view-bam-files"><i class="fa fa-check"></i><b>3.3.2</b> View BAM Files</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#public-data-repositories"><i class="fa fa-check"></i><b>3.4</b> Public data repositories</a><ul>
<li class="chapter" data-level="3.4.1" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#cellranger10x"><i class="fa fa-check"></i><b>3.4.1</b> Cellranger/10x</a></li>
<li class="chapter" data-level="3.4.2" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#geo"><i class="fa fa-check"></i><b>3.4.2</b> GEO</a></li>
<li class="chapter" data-level="3.4.3" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#single-cell-portal"><i class="fa fa-check"></i><b>3.4.3</b> Single Cell Portal</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="understanding-sequencing-raw-data.html"><a href="understanding-sequencing-raw-data.html#docker-commands"><i class="fa fa-check"></i><b>3.5</b> Docker Commands</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="transcriptome-quantification.html"><a href="transcriptome-quantification.html"><i class="fa fa-check"></i><b>4</b> Transcriptome Quantification</a><ul>
<li class="chapter" data-level="4.1" data-path="transcriptome-quantification.html"><a href="transcriptome-quantification.html#google-slides"><i class="fa fa-check"></i><b>4.1</b> Google Slides</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html"><i class="fa fa-check"></i><b>5</b> Processing scRNAseq Data</a><ul>
<li class="chapter" data-level="5.1" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#goal"><i class="fa fa-check"></i><b>5.1</b> Goal</a></li>
<li class="chapter" data-level="5.2" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#further-reading"><i class="fa fa-check"></i><b>5.2</b> Further reading</a></li>
<li class="chapter" data-level="5.3" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#download-data"><i class="fa fa-check"></i><b>5.3</b> Download data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#fastq-file-format"><i class="fa fa-check"></i><b>5.3.1</b> Fastq file format</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#align-the-reads"><i class="fa fa-check"></i><b>5.4</b> Align the reads</a><ul>
<li class="chapter" data-level="5.4.1" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#star-align"><i class="fa fa-check"></i><b>5.4.1</b> STAR align</a></li>
<li class="chapter" data-level="5.4.2" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#bam-file-format"><i class="fa fa-check"></i><b>5.4.2</b> Bam file format</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="processing-scrnaseq-data.html"><a href="processing-scrnaseq-data.html#visualization"><i class="fa fa-check"></i><b>5.5</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html"><i class="fa fa-check"></i><b>6</b> Introduction R/Bioconductor</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#start-environment"><i class="fa fa-check"></i><b>6.1</b> Start Environment</a><ul>
<li class="chapter" data-level="6.1.1" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#local-command"><i class="fa fa-check"></i><b>6.1.1</b> Local Command</a></li>
<li class="chapter" data-level="6.1.2" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#aws-command"><i class="fa fa-check"></i><b>6.1.2</b> AWS Command</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#installing-packages"><i class="fa fa-check"></i><b>6.2</b> Installing packages</a><ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#cran"><i class="fa fa-check"></i><b>6.2.1</b> CRAN</a></li>
<li class="chapter" data-level="6.2.2" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#github"><i class="fa fa-check"></i><b>6.2.2</b> Github</a></li>
<li class="chapter" data-level="6.2.3" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#bioconductor"><i class="fa fa-check"></i><b>6.2.3</b> Bioconductor</a></li>
<li class="chapter" data-level="6.2.4" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#source"><i class="fa fa-check"></i><b>6.2.4</b> Source</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#installation-instructions"><i class="fa fa-check"></i><b>6.3</b> Installation instructions:</a><ul>
<li class="chapter" data-level="6.3.1" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#classestypes"><i class="fa fa-check"></i><b>6.3.1</b> Classes/Types</a></li>
<li class="chapter" data-level="6.3.2" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#data-structures"><i class="fa fa-check"></i><b>6.3.2</b> Data structures</a></li>
<li class="chapter" data-level="6.3.3" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#detour-to-s3s4"><i class="fa fa-check"></i><b>6.3.3</b> Detour to S3/S4</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#more-information"><i class="fa fa-check"></i><b>6.4</b> More information</a><ul>
<li class="chapter" data-level="6.4.1" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#checking-for-help-for-any-function"><i class="fa fa-check"></i><b>6.4.1</b> Checking for help for any function!</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#grammer-of-graphics-ggplot2"><i class="fa fa-check"></i><b>6.5</b> Grammer of Graphics (ggplot2)</a><ul>
<li class="chapter" data-level="6.5.1" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#what-is-ggplot2"><i class="fa fa-check"></i><b>6.5.1</b> What is ggplot2?</a></li>
<li class="chapter" data-level="6.5.2" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#principles-of-ggplot2"><i class="fa fa-check"></i><b>6.5.2</b> Principles of ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="introduction-rbioconductor.html"><a href="introduction-rbioconductor.html#reference"><i class="fa fa-check"></i><b>6.6</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="quality-control.html"><a href="quality-control.html"><i class="fa fa-check"></i><b>7</b> Quality Control</a><ul>
<li class="chapter" data-level="7.1" data-path="quality-control.html"><a href="quality-control.html#slides-1"><i class="fa fa-check"></i><b>7.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html"><i class="fa fa-check"></i><b>8</b> Data Wrangling scRNAseq</a><ul>
<li class="chapter" data-level="8.1" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#goal-1"><i class="fa fa-check"></i><b>8.1</b> Goal</a></li>
<li class="chapter" data-level="8.2" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#introduction-2"><i class="fa fa-check"></i><b>8.2</b> Introduction</a><ul>
<li class="chapter" data-level="8.2.1" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#load-necessary-packages"><i class="fa fa-check"></i><b>8.2.1</b> Load necessary packages</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#read-in-nsclc-counts-matrix."><i class="fa fa-check"></i><b>8.2.2</b> Read in NSCLC counts matrix.</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#lets-examine-the-sparse-counts-matrix"><i class="fa fa-check"></i><b>8.2.3</b> Let’s examine the sparse counts matrix</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#how-big-is-the-matrix"><i class="fa fa-check"></i><b>8.2.4</b> How big is the matrix?</a></li>
<li class="chapter" data-level="8.2.5" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#how-much-memory-does-a-sparse-matrix-take-up-relative-to-a-dense-matrix"><i class="fa fa-check"></i><b>8.2.5</b> How much memory does a sparse matrix take up relative to a dense matrix?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#filtering-low-quality-cells"><i class="fa fa-check"></i><b>8.3</b> Filtering low-quality cells</a><ul>
<li class="chapter" data-level="8.3.1" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#look-at-the-summary-counts-for-genes-and-cells"><i class="fa fa-check"></i><b>8.3.1</b> Look at the summary counts for genes and cells</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#plot-cells-ranked-by-their-number-of-detected-genes."><i class="fa fa-check"></i><b>8.3.2</b> Plot cells ranked by their number of detected genes.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#beginning-with-seurat-httpsatijalab.orgseurat"><i class="fa fa-check"></i><b>8.4</b> Beginning with Seurat: <span>http://satijalab.org/seurat/</span></a><ul>
<li class="chapter" data-level="8.4.1" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#creating-a-seurat-object"><i class="fa fa-check"></i><b>8.4.1</b> Creating a seurat object</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#preprocessing-step-1-filter-out-low-quality-cells"><i class="fa fa-check"></i><b>8.5</b> Preprocessing step 1 : Filter out low-quality cells</a></li>
<li class="chapter" data-level="8.6" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#examine-contents-of-seurat-object"><i class="fa fa-check"></i><b>8.6</b> Examine contents of Seurat object</a><ul>
<li class="chapter" data-level="8.6.1" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#preprocessing-step-2-expression-normalization"><i class="fa fa-check"></i><b>8.6.1</b> Preprocessing step 2 : Expression normalization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#detection-of-variable-genes-across-the-single-cells"><i class="fa fa-check"></i><b>8.7</b> Detection of variable genes across the single cells</a></li>
<li class="chapter" data-level="8.8" data-path="data-wrangling-scrnaseq.html"><a href="data-wrangling-scrnaseq.html#gene-set-expression-across-cells"><i class="fa fa-check"></i><b>8.8</b> Gene set expression across cells</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="identifying-cell-populations.html"><a href="identifying-cell-populations.html"><i class="fa fa-check"></i><b>9</b> Identifying Cell Populations</a><ul>
<li class="chapter" data-level="9.1" data-path="identifying-cell-populations.html"><a href="identifying-cell-populations.html#slides-2"><i class="fa fa-check"></i><b>9.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html"><i class="fa fa-check"></i><b>10</b> Feature Selection and Cluster Analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#abstract"><i class="fa fa-check"></i><b>10.1</b> Abstract</a></li>
<li class="chapter" data-level="10.2" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#seurat-tutorial-redo"><i class="fa fa-check"></i><b>10.2</b> Seurat Tutorial Redo</a><ul>
<li class="chapter" data-level="10.2.1" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#preprocessing-steps"><i class="fa fa-check"></i><b>10.2.1</b> Preprocessing Steps</a></li>
<li class="chapter" data-level="10.2.2" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#start-of-identifying-cell-types"><i class="fa fa-check"></i><b>10.2.2</b> Start of Identifying Cell Types</a></li>
<li class="chapter" data-level="10.2.3" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#run-non-linear-dimensional-reduction-umaptsne"><i class="fa fa-check"></i><b>10.2.3</b> Run non-linear dimensional reduction (UMAP/tSNE)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#feature-selection"><i class="fa fa-check"></i><b>10.3</b> Feature Selection</a><ul>
<li class="chapter" data-level="10.3.1" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#differential-expression-analysis"><i class="fa fa-check"></i><b>10.3.1</b> Differential Expression Analysis</a></li>
<li class="chapter" data-level="10.3.2" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#check-clusters"><i class="fa fa-check"></i><b>10.3.2</b> Check Clusters</a></li>
<li class="chapter" data-level="10.3.3" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#view-entire-object-structure"><i class="fa fa-check"></i><b>10.3.3</b> View Entire Object Structure</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#probabilistic-lda-clustering"><i class="fa fa-check"></i><b>10.4</b> Probabilistic (LDA) Clustering</a><ul>
<li class="chapter" data-level="10.4.1" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#example-lda-in-bulk"><i class="fa fa-check"></i><b>10.4.1</b> Example LDA in Bulk</a></li>
<li class="chapter" data-level="10.4.2" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#pbmc-lda"><i class="fa fa-check"></i><b>10.4.2</b> PBMC LDA</a></li>
<li class="chapter" data-level="10.4.3" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#practice-visualizingembedding"><i class="fa fa-check"></i><b>10.4.3</b> Practice Visualizing/Embedding</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="feature-selection-and-cluster-analysis.html"><a href="feature-selection-and-cluster-analysis.html#other-options-for-analysis"><i class="fa fa-check"></i><b>10.5</b> Other Options For Analysis</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="batch-correction-lecture.html"><a href="batch-correction-lecture.html"><i class="fa fa-check"></i><b>11</b> Batch Correction Lecture</a><ul>
<li class="chapter" data-level="11.1" data-path="batch-correction-lecture.html"><a href="batch-correction-lecture.html#slides-3"><i class="fa fa-check"></i><b>11.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html"><i class="fa fa-check"></i><b>12</b> Batch Correction Lab</a><ul>
<li class="chapter" data-level="12.1" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#load-settings-and-packages"><i class="fa fa-check"></i><b>12.1</b> Load settings and packages</a></li>
<li class="chapter" data-level="12.2" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#read-in-pancreas-expression-matrices"><i class="fa fa-check"></i><b>12.2</b> Read in pancreas expression matrices</a></li>
<li class="chapter" data-level="12.3" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#preparing-the-individual-seurat-objects-for-each-pancreas-dataset-without-batch-correction"><i class="fa fa-check"></i><b>12.3</b> Preparing the individual Seurat objects for each pancreas dataset without batch correction</a></li>
<li class="chapter" data-level="12.4" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#cluster-pancreatic-datasets-without-batch-correction"><i class="fa fa-check"></i><b>12.4</b> Cluster pancreatic datasets without batch correction</a><ul>
<li class="chapter" data-level="12.4.1" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#batch-correction-canonical-correlation-analysis-cca-mutual-nearest-neighbors-mnn-using-seurat-v3"><i class="fa fa-check"></i><b>12.4.1</b> Batch correction: canonical correlation analysis (CCA) + mutual nearest neighbors (MNN) using Seurat v3</a></li>
<li class="chapter" data-level="12.4.2" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#batch-correction-integrative-non-negative-matrix-factorization-nmf-using-liger"><i class="fa fa-check"></i><b>12.4.2</b> Batch correction: integrative non-negative matrix factorization (NMF) using LIGER</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#additional-exploration-regressing-out-unwanted-covariates"><i class="fa fa-check"></i><b>12.5</b> Additional exploration: Regressing out unwanted covariates</a></li>
<li class="chapter" data-level="12.6" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#additional-exploration-kbet"><i class="fa fa-check"></i><b>12.6</b> Additional exploration: kBET</a></li>
<li class="chapter" data-level="12.7" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#additional-exploration-seurat-3"><i class="fa fa-check"></i><b>12.7</b> Additional exploration: Seurat 3</a></li>
<li class="chapter" data-level="12.8" data-path="batch-correction-lab.html"><a href="batch-correction-lab.html#acknowledgements"><i class="fa fa-check"></i><b>12.8</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="trajectory-inference.html"><a href="trajectory-inference.html"><i class="fa fa-check"></i><b>13</b> Trajectory Inference</a><ul>
<li class="chapter" data-level="13.1" data-path="trajectory-inference.html"><a href="trajectory-inference.html#slides-4"><i class="fa fa-check"></i><b>13.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html"><i class="fa fa-check"></i><b>14</b> Trajectory Analysis</a><ul>
<li class="chapter" data-level="14.1" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#load-settings-and-packages-1"><i class="fa fa-check"></i><b>14.1</b> Load settings and packages</a></li>
<li class="chapter" data-level="14.2" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#first-look-at-the-differentiation-data-from-deng-et-al."><i class="fa fa-check"></i><b>14.2</b> First look at the differentiation data from Deng et al.</a></li>
<li class="chapter" data-level="14.3" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#principle-components-analysis"><i class="fa fa-check"></i><b>14.3</b> Principle Components Analysis</a></li>
<li class="chapter" data-level="14.4" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#diffusion-map-pseudotime"><i class="fa fa-check"></i><b>14.4</b> Diffusion map pseudotime</a></li>
<li class="chapter" data-level="14.5" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#slingshot-map-pseudotime"><i class="fa fa-check"></i><b>14.5</b> Slingshot map pseudotime</a></li>
<li class="chapter" data-level="14.6" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#find-temporally-expressed-genes"><i class="fa fa-check"></i><b>14.6</b> Find temporally expressed genes</a></li>
<li class="chapter" data-level="14.7" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#comparison-of-the-different-trajectory-inference-methods"><i class="fa fa-check"></i><b>14.7</b> Comparison of the different trajectory inference methods</a></li>
<li class="chapter" data-level="14.8" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#plots-of-gene-expression-over-time."><i class="fa fa-check"></i><b>14.8</b> Plots of gene expression over time.</a></li>
<li class="chapter" data-level="14.9" data-path="trajectory-analysis.html"><a href="trajectory-analysis.html#acknowledgements-1"><i class="fa fa-check"></i><b>14.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mutli-omic-analysis.html"><a href="mutli-omic-analysis.html"><i class="fa fa-check"></i><b>15</b> Mutli-omic Analysis</a><ul>
<li class="chapter" data-level="15.1" data-path="mutli-omic-analysis.html"><a href="mutli-omic-analysis.html#slides-5"><i class="fa fa-check"></i><b>15.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="cite-seq.html"><a href="cite-seq.html"><i class="fa fa-check"></i><b>16</b> CITE-Seq</a><ul>
<li class="chapter" data-level="16.1" data-path="cite-seq.html"><a href="cite-seq.html#load-settings-and-packages-2"><i class="fa fa-check"></i><b>16.1</b> Load settings and packages</a></li>
<li class="chapter" data-level="16.2" data-path="cite-seq.html"><a href="cite-seq.html#load-in-the-data"><i class="fa fa-check"></i><b>16.2</b> Load in the data</a></li>
<li class="chapter" data-level="16.3" data-path="cite-seq.html"><a href="cite-seq.html#setup-a-seurat-object-and-cluster-cells-based-on-rna-expression"><i class="fa fa-check"></i><b>16.3</b> Setup a Seurat object, and cluster cells based on RNA expression</a></li>
<li class="chapter" data-level="16.4" data-path="cite-seq.html"><a href="cite-seq.html#add-the-protein-expression-levels-to-the-seurat-object"><i class="fa fa-check"></i><b>16.4</b> Add the protein expression levels to the Seurat object</a></li>
<li class="chapter" data-level="16.5" data-path="cite-seq.html"><a href="cite-seq.html#visualize-protein-levels-on-rna-clusters"><i class="fa fa-check"></i><b>16.5</b> Visualize protein levels on RNA clusters</a></li>
<li class="chapter" data-level="16.6" data-path="cite-seq.html"><a href="cite-seq.html#identify-differentially-expressed-proteins-between-clusters"><i class="fa fa-check"></i><b>16.6</b> Identify differentially expressed proteins between clusters</a></li>
<li class="chapter" data-level="16.7" data-path="cite-seq.html"><a href="cite-seq.html#cluster-directly-on-protein-levels"><i class="fa fa-check"></i><b>16.7</b> Cluster directly on protein levels</a></li>
<li class="chapter" data-level="16.8" data-path="cite-seq.html"><a href="cite-seq.html#additional-exploration-another-example-of-multi-modal-analysis"><i class="fa fa-check"></i><b>16.8</b> Additional exploration: another example of multi-modal analysis</a></li>
<li class="chapter" data-level="16.9" data-path="cite-seq.html"><a href="cite-seq.html#acknowledgements-2"><i class="fa fa-check"></i><b>16.9</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="diy-project.html"><a href="diy-project.html"><i class="fa fa-check"></i><b>17</b> DIY Project</a><ul>
<li class="chapter" data-level="17.1" data-path="diy-project.html"><a href="diy-project.html#slides-6"><i class="fa fa-check"></i><b>17.1</b> Slides</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="diy-lab.html"><a href="diy-lab.html"><i class="fa fa-check"></i><b>18</b> DIY Lab</a><ul>
<li class="chapter" data-level="18.1" data-path="diy-lab.html"><a href="diy-lab.html#diy-lab-1"><i class="fa fa-check"></i><b>18.1</b> DIY Lab</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="single-cell-resources.html"><a href="single-cell-resources.html"><i class="fa fa-check"></i><b>19</b> Single Cell Resources</a><ul>
<li class="chapter" data-level="19.1" data-path="single-cell-resources.html"><a href="single-cell-resources.html#comprehensive-list-of-single-cell-resources"><i class="fa fa-check"></i><b>19.1</b> Comprehensive list of single-cell resources</a></li>
<li class="chapter" data-level="19.2" data-path="single-cell-resources.html"><a href="single-cell-resources.html#computational-packages-for-single-cell-analysis"><i class="fa fa-check"></i><b>19.2</b> Computational packages for single-cell analysis</a></li>
<li class="chapter" data-level="19.3" data-path="single-cell-resources.html"><a href="single-cell-resources.html#elife-commentary-on-the-human-cell-atlas"><i class="fa fa-check"></i><b>19.3</b> eLife Commentary on the Human Cell Atlas</a></li>
<li class="chapter" data-level="19.4" data-path="single-cell-resources.html"><a href="single-cell-resources.html#online-courses"><i class="fa fa-check"></i><b>19.4</b> Online courses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ANALYSIS OF SINGLE CELL RNA-SEQ DATA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trajectory-analysis" class="section level1">
<h1><span class="header-section-number">14</span> Trajectory Analysis</h1>
<p>In this lab, we will analyze a single cell RNA-seq dataset that will teach us about several methods to infer the differentiation trajectory of a set of cells. These methods can order a set of individual cells along a path / trajectory / lineage, and assign a pseudotime value to each cell that represents where the cell is along that path. This can be a starting point for further analysis to determine gene expression programs driving interesting cell phenotypes. As you are running the code, think about how the algorithms work and what you like and do not like about the assumptions and utilities provided by the algorithm.</p>
<div id="load-settings-and-packages-1" class="section level2">
<h2><span class="header-section-number">14.1</span> Load settings and packages</h2>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb495-1" data-line-number="1"><span class="kw">library</span>(SingleCellExperiment)  <span class="co"># way to store single cell data</span></a></code></pre></div>
<pre><code>## Loading required package: SummarizedExperiment</code></pre>
<pre><code>## Loading required package: GenomicRanges</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;BiocGenerics&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following object is masked from &#39;package:liger&#39;:
## 
##     normalize</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     combine, intersect, setdiff, union</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     which</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     anyDuplicated, append, as.data.frame, basename, cbind, colnames,
##     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
##     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
##     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
##     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
##     union, unique, unsplit, which, which.max, which.min</code></pre>
<pre><code>## Loading required package: S4Vectors</code></pre>
<pre><code>## 
## Attaching package: &#39;S4Vectors&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     rename</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     first, rename</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     expand.grid</code></pre>
<pre><code>## Loading required package: IRanges</code></pre>
<pre><code>## 
## Attaching package: &#39;IRanges&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     desc</code></pre>
<pre><code>## The following object is masked from &#39;package:sp&#39;:
## 
##     %over%</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     collapse, desc, slice</code></pre>
<pre><code>## Loading required package: GenomeInfoDb</code></pre>
<pre><code>## Loading required package: Biobase</code></pre>
<pre><code>## Welcome to Bioconductor
## 
##     Vignettes contain introductory material; view with
##     &#39;browseVignettes()&#39;. To cite Bioconductor, see
##     &#39;citation(&quot;Biobase&quot;)&#39;, and for packages &#39;citation(&quot;pkgname&quot;)&#39;.</code></pre>
<pre><code>## Loading required package: DelayedArray</code></pre>
<pre><code>## Loading required package: matrixStats</code></pre>
<pre><code>## 
## Attaching package: &#39;matrixStats&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:Biobase&#39;:
## 
##     anyMissing, rowMedians</code></pre>
<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     count</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     count</code></pre>
<pre><code>## Loading required package: BiocParallel</code></pre>
<pre><code>## 
## Attaching package: &#39;DelayedArray&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:matrixStats&#39;:
## 
##     colMaxs, colMins, colRanges, rowMaxs, rowMins, rowRanges</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     aperm, apply, rowsum</code></pre>
<pre><code>## 
## Attaching package: &#39;SummarizedExperiment&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Seurat&#39;:
## 
##     Assays</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" data-line-number="1"><span class="kw">library</span>(destiny)  <span class="co"># diffusion maps and diffusion pseudotime</span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;destiny&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:SummarizedExperiment&#39;:
## 
##     distance</code></pre>
<pre><code>## The following object is masked from &#39;package:GenomicRanges&#39;:
## 
##     distance</code></pre>
<pre><code>## The following object is masked from &#39;package:IRanges&#39;:
## 
##     distance</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" data-line-number="1"><span class="kw">library</span>(scater)  <span class="co"># related SingleCellExperiment package</span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;scater&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:liger&#39;:
## 
##     runTSNE, runUMAP</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" data-line-number="1"><span class="kw">library</span>(clusterExperiment)</a></code></pre></div>
<pre><code>## Registered S3 methods overwritten by &#39;registry&#39;:
##   method               from 
##   print.registry_field proxy
##   print.registry_entry proxy</code></pre>
<pre><code>## 
## Attaching package: &#39;clusterExperiment&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:scater&#39;:
## 
##     plotHeatmap</code></pre>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" data-line-number="1"><span class="kw">library</span>(gam)</a></code></pre></div>
<pre><code>## Loading required package: splines</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loaded gam 1.16.1</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb550-1" data-line-number="1"><span class="kw">library</span>(corrplot)</a></code></pre></div>
<pre><code>## corrplot 0.84 loaded</code></pre>
<pre><code>## 
## Attaching package: &#39;corrplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:destiny&#39;:
## 
##     colorlegend</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb554-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb554-2" data-line-number="2"><span class="kw">library</span>(ggthemes)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ggthemes&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:cowplot&#39;:
## 
##     theme_map</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" data-line-number="1"><span class="kw">library</span>(ggbeeswarm)</a>
<a class="sourceLine" id="cb557-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb557-3" data-line-number="3"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb557-4" data-line-number="4"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb557-5" data-line-number="5"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb557-6" data-line-number="6"></a>
<a class="sourceLine" id="cb557-7" data-line-number="7"><span class="co"># Set folder location for saving output files. This is also the same location as input data.</span></a>
<a class="sourceLine" id="cb557-8" data-line-number="8">mydir &lt;-<span class="st"> &quot;data/trajectory/&quot;</span></a>
<a class="sourceLine" id="cb557-9" data-line-number="9"><span class="kw">setwd</span>(<span class="st">&quot;/home/rstudio/materials/&quot;</span>) </a>
<a class="sourceLine" id="cb557-10" data-line-number="10"></a>
<a class="sourceLine" id="cb557-11" data-line-number="11"><span class="co"># Objects to save.</span></a>
<a class="sourceLine" id="cb557-12" data-line-number="12">Rda.destiny.path &lt;-<span class="st"> </span><span class="kw">paste0</span>(mydir, <span class="st">&quot;trajectory_destiny.Rda&quot;</span>)</a>
<a class="sourceLine" id="cb557-13" data-line-number="13">Rda.slingshot.path &lt;-<span class="st"> </span><span class="kw">paste0</span>(mydir, <span class="st">&quot;trajectory_slingshot.Rda&quot;</span>)</a>
<a class="sourceLine" id="cb557-14" data-line-number="14"></a>
<a class="sourceLine" id="cb557-15" data-line-number="15"><span class="kw">set.seed</span>(<span class="dv">1</span>)  <span class="co"># set a seed for your random number generator to get reproducible results </span></a>
<a class="sourceLine" id="cb557-16" data-line-number="16">opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">fig.align =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
</div>
<div id="first-look-at-the-differentiation-data-from-deng-et-al." class="section level2">
<h2><span class="header-section-number">14.2</span> First look at the differentiation data from Deng et al.</h2>
<p>We will use a nice SMART-Seq2 single cell RNA-seq data from <a href="http://science.sciencemag.org/content/343/6167/193">Single-Cell RNA-Seq Reveals Dynamic, Random Monoallelic Gene Expression in Mammalian Cells</a>. Here is one relevant detail from their paper: “To investigate allele-specific gene expression at single-cell resolution, we isolated 269 individual cells dissociated from in vivo F1 embryos (CAST/EiJ × C57BL/6J, hereafter abbreviated as CAST and C57, respectively) from oocyte to blastocyst stages of mouse preimplantation development (PD)”</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb558-1" data-line-number="1"><span class="co"># Read in single cell data.</span></a>
<a class="sourceLine" id="cb558-2" data-line-number="2">path.deng &lt;-<span class="st"> </span><span class="kw">paste0</span>(mydir, <span class="st">&quot;deng-reads.rds&quot;</span>)</a>
<a class="sourceLine" id="cb558-3" data-line-number="3">deng_SCE &lt;-<span class="st"> </span><span class="kw">readRDS</span>(path.deng)</a>
<a class="sourceLine" id="cb558-4" data-line-number="4"></a>
<a class="sourceLine" id="cb558-5" data-line-number="5"><span class="co"># What class is the deng_SCE object, and how is it organized?</span></a>
<a class="sourceLine" id="cb558-6" data-line-number="6"><span class="kw">class</span>(deng_SCE)</a></code></pre></div>
<pre><code>## [1] &quot;SingleCellExperiment&quot;
## attr(,&quot;package&quot;)
## [1] &quot;SingleCellExperiment&quot;</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" data-line-number="1"><span class="kw">structure</span>(deng_SCE)</a></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 22431 268 
## metadata(0):
## assays(2): counts logcounts
## rownames(22431): Hvcn1 Gbp7 ... Sox5 Alg11
## rowData names(10): feature_symbol is_feature_control ... total_counts
##   log10_total_counts
## colnames(268): 16cell 16cell.1 ... zy.2 zy.3
## colData names(30): cell_type2 cell_type1 ... pct_counts_ERCC
##   is_cell_control
## reducedDimNames(0):
## spikeNames(1): ERCC
## altExpNames(0):</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" data-line-number="1"><span class="co"># How many mouse cells are at each stage?</span></a>
<a class="sourceLine" id="cb562-2" data-line-number="2"><span class="kw">table</span>(deng_SCE<span class="op">$</span>cell_type1)</a></code></pre></div>
<pre><code>## 
## 16cell  2cell  4cell  8cell  blast zygote 
##     50     22     14     37    133     12</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb564-1" data-line-number="1"><span class="kw">table</span>(deng_SCE<span class="op">$</span>cell_type2)</a></code></pre></div>
<pre><code>## 
##     16cell      4cell      8cell early2cell earlyblast  late2cell  lateblast 
##         50         14         37          8         43         10         30 
##   mid2cell   midblast         zy 
##         12         60          4</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" data-line-number="1"><span class="co"># Re-order the levels of the factor storing the cell developmental stage.</span></a>
<a class="sourceLine" id="cb566-2" data-line-number="2">deng_SCE<span class="op">$</span>cell_type2 &lt;-<span class="st"> </span><span class="kw">factor</span>(deng_SCE<span class="op">$</span>cell_type2,</a>
<a class="sourceLine" id="cb566-3" data-line-number="3">                              <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;zy&quot;</span>, <span class="st">&quot;early2cell&quot;</span>, <span class="st">&quot;mid2cell&quot;</span>, <span class="st">&quot;late2cell&quot;</span>, </a>
<a class="sourceLine" id="cb566-4" data-line-number="4">                                         <span class="st">&quot;4cell&quot;</span>, <span class="st">&quot;8cell&quot;</span>, <span class="st">&quot;16cell&quot;</span>, <span class="st">&quot;earlyblast&quot;</span>,</a>
<a class="sourceLine" id="cb566-5" data-line-number="5">                                         <span class="st">&quot;midblast&quot;</span>, <span class="st">&quot;lateblast&quot;</span>))</a></code></pre></div>
</div>
<div id="principle-components-analysis" class="section level2">
<h2><span class="header-section-number">14.3</span> Principle Components Analysis</h2>
<p>Let us take a first look at the Deng data. One simple approach to ordering cells in pseudotime is to use PCA. By carrying out PCA and labeling the cells by the stage at which they were collected, we can see how well the principal components separate cells along a differentiation trajectory.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" data-line-number="1"><span class="co"># Run PCA on Deng data. Use the runPCA function from the SingleCellExperiment package.</span></a>
<a class="sourceLine" id="cb567-2" data-line-number="2">deng_SCE &lt;-<span class="st"> </span><span class="kw">runPCA</span>(deng_SCE, <span class="dt">ncomponents =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb567-3" data-line-number="3"></a>
<a class="sourceLine" id="cb567-4" data-line-number="4"><span class="co"># Use the reducedDim function to access the PCA and store the results. </span></a>
<a class="sourceLine" id="cb567-5" data-line-number="5">pca &lt;-<span class="st"> </span><span class="kw">reducedDim</span>(deng_SCE, <span class="st">&quot;PCA&quot;</span>)</a>
<a class="sourceLine" id="cb567-6" data-line-number="6"></a>
<a class="sourceLine" id="cb567-7" data-line-number="7"><span class="co"># Describe how the PCA is stored in a matrix. Why does it have this structure?</span></a>
<a class="sourceLine" id="cb567-8" data-line-number="8"><span class="kw">head</span>(pca)</a></code></pre></div>
<pre><code>##               PC1       PC2       PC3         PC4        PC5        PC6
## 16cell   24.79868 -62.20826  8.035201 -2.07391816  2.1297390 14.0930954
## 16cell.1 28.77121 -50.35974 13.607012  0.08664449  0.9454185  3.5987880
## 16cell.2 26.67901 -61.03875  7.239352 -6.60967794 -1.0775002 11.8876579
## 16cell.3 29.01151 -56.03620  6.433057  2.85332708 -4.2885083 -0.1488504
## 16cell.4 26.38026 -58.09265  4.671850  7.99519397  9.8077416  2.0570042
## 16cell.5 24.90566 -60.77897  5.632497 -3.80156587  9.8835527 11.9028394
##                 PC7        PC8       PC9      PC10       PC11        PC12
## 16cell    2.4645020  1.6350660  7.202260  9.862212 -10.660702  -0.6401721
## 16cell.1  2.1726663 -3.3481641  8.967394  6.664942 -14.493227 -11.7471565
## 16cell.2 -7.9007309  0.3368756  6.032645  5.295515 -15.384993  -4.2930696
## 16cell.3 -4.3727592 -1.1582470  1.520145 -8.789699 -19.386866   0.4999047
## 16cell.4 -0.6031572 -3.6743278  5.793753 10.823787  -7.613724  -4.7288640
## 16cell.5 -4.3269009  3.8968881 11.805221  9.798854 -11.016137 -19.1535086
##               PC13      PC14       PC15       PC16      PC17       PC18
## 16cell   -5.716841  6.544614  -6.652210  -3.458346  4.499013 -11.360753
## 16cell.1 13.284708 -4.206404  -8.721043  -7.926277  0.703508  -5.418131
## 16cell.2  9.633173  1.672498  -9.609001  -9.302794 10.219743  -5.763834
## 16cell.3 14.177687 -8.509097  -6.978210  10.771078  6.188808   6.504081
## 16cell.4  3.106382 -4.078414 -10.739979 -12.032452  6.239499   2.331292
## 16cell.5  9.544362 -2.255400  -8.614958  -2.832196  1.798584   2.321082
##                 PC19      PC20      PC21       PC22       PC23      PC24
## 16cell     2.2617345 -2.456274 11.227414  1.7122827  -8.418641  4.254968
## 16cell.1 -11.8613891  4.069530  9.320831  0.5802347 -11.878096 -6.412425
## 16cell.2  -3.3460356  4.165813  2.031473 -2.1106373  -1.762218 -1.135134
## 16cell.3  -0.6042649  6.008176  9.982856  9.4888653   2.822138 12.871921
## 16cell.4   3.9402029 -0.298227 10.773722 -0.6374236   4.730329  4.670391
## 16cell.5  -2.0280791  5.050525 -3.252243 -7.1527175  -9.923140 -1.791511
##               PC25       PC26       PC27      PC28         PC29      PC30
## 16cell   -4.049629  -4.133374  0.6235391 -3.381254 -13.94917609  8.217824
## 16cell.1 -8.052083  -8.334263  0.5815629  4.592214  -1.32417854 -5.266909
## 16cell.2 -2.326133  -3.775858  2.3388745 -6.947394  -0.08121559  2.942813
## 16cell.3 -5.860750  -1.869659 -7.0402429  5.092207   2.53575943 18.529304
## 16cell.4 -4.291113 -13.005331 -3.2802102  4.606226   3.52531994  3.599833
## 16cell.5  4.708265  -5.717693 -1.1023767  9.761377   4.57312078 12.138646
##                PC31      PC32        PC33      PC34       PC35       PC36
## 16cell    -6.897320  5.675943   8.6076039  3.713348  0.9099737  4.7467546
## 16cell.1  -4.538307 -9.166969  -9.4525575  8.848231  2.0782319  7.4318993
## 16cell.2   3.082470  2.207176   0.5365986  3.895378 -7.4493361  0.7465149
## 16cell.3   1.680117  3.839556 -13.3156066  6.257479  4.1112596  0.2780589
## 16cell.4 -13.314741  1.453554   0.1334034 -2.941487  0.8162660 -2.9940693
## 16cell.5  -4.608498 12.180530   5.8667454 -6.645273 -1.0224859  0.8960299
##               PC37       PC38       PC39      PC40       PC41       PC42
## 16cell   -9.063470 -5.2765051 -1.1758453  9.474215  -3.559391  4.7781174
## 16cell.1 -6.217009  1.0216459 -0.5798035 21.705585   3.570104 -2.3279923
## 16cell.2 -6.227582  3.0863112 -8.6153521 -1.401230  -2.266017 -0.8150665
## 16cell.3 -8.411600  3.7169411  0.7050601  2.959623   3.123082 -1.0916370
## 16cell.4  2.871774 -4.2664023  7.4894594 -8.207422  -4.223035  1.4763577
## 16cell.5 10.169730  0.3923632  9.3346900  8.114487 -11.186021  4.5635674
##                 PC43      PC44      PC45      PC46        PC47      PC48
## 16cell   -7.92280920 -8.558202  7.058962 -3.058208  -0.5723866  4.674956
## 16cell.1  5.60067539  8.717056 -6.480960 -8.554813 -13.1868736  3.397938
## 16cell.2  5.25328812 -5.803788  2.726822 -1.241769   7.4824415 -4.088461
## 16cell.3 -0.05135523 -2.181424  2.404780 -8.691230   8.9700016 -3.713540
## 16cell.4  1.55019720  4.946841  0.520753  3.068227  10.7801148  5.167658
## 16cell.5 -9.98211745 -8.759947 -3.727758  9.064882  -1.7524456 -3.306621
##               PC49       PC50
## 16cell    2.936258  3.5978317
## 16cell.1  3.420235 -3.4895386
## 16cell.2 -4.446014 -0.2326760
## 16cell.3  5.179604  9.7144236
## 16cell.4  1.077789  3.0529018
## 16cell.5 -5.019027  0.9275007</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" data-line-number="1"><span class="kw">dim</span>(pca)</a></code></pre></div>
<pre><code>## [1] 268  50</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" data-line-number="1"><span class="co"># Add PCA data (first two PCs) to the deng_SCE object.</span></a>
<a class="sourceLine" id="cb571-2" data-line-number="2">deng_SCE<span class="op">$</span>PC1 &lt;-<span class="st"> </span>pca[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb571-3" data-line-number="3">deng_SCE<span class="op">$</span>PC2 &lt;-<span class="st"> </span>pca[, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb571-4" data-line-number="4"><span class="kw">head</span>(<span class="kw">colData</span>(deng_SCE))</a></code></pre></div>
<pre><code>## DataFrame with 6 rows and 32 columns
##          cell_type2  cell_type1 total_features log10_total_features
##            &lt;factor&gt; &lt;character&gt;      &lt;integer&gt;            &lt;numeric&gt;
## 16cell       16cell      16cell           7882     3.89669152656288
## 16cell.1     16cell      16cell           7671     3.88490859416261
## 16cell.2     16cell      16cell           8012     3.90379514274104
## 16cell.3     16cell      16cell           7980     3.90205731080847
## 16cell.4     16cell      16cell           8179     3.91275330367132
## 16cell.5     16cell      16cell           7291     3.86284665998294
##          total_counts log10_total_counts pct_counts_top_50_features
##             &lt;integer&gt;          &lt;numeric&gt;                  &lt;numeric&gt;
## 16cell        8825980   6.94576298819116           16.1419581734833
## 16cell.1      7714601   6.88731352551746           14.3400287325294
## 16cell.2      8074971   6.90714102508777           16.2521450541432
## 16cell.3      6334456    6.8017093923827           14.7442337589842
## 16cell.4      9885518   6.99499947515896           14.8676680372237
## 16cell.5     10571900   7.02415308755133           15.0683037107805
##          pct_counts_top_100_features pct_counts_top_200_features
##                            &lt;numeric&gt;                   &lt;numeric&gt;
## 16cell              22.9905574225185            31.9837570445435
## 16cell.1            20.7937779283724            29.2256333153199
## 16cell.2            23.0008380215855            32.0749387211422
## 16cell.3            21.3769738080113            30.2242213064547
## 16cell.4            21.4405557705727            29.9306015122323
## 16cell.5            21.4823636243249             30.227310133467
##          pct_counts_top_500_features total_features_endogenous
##                            &lt;numeric&gt;                 &lt;integer&gt;
## 16cell              47.7577107584654                      7882
## 16cell.1            44.9996701060755                      7671
## 16cell.2            47.7693356421961                      8012
## 16cell.3            46.1895070389628                      7980
## 16cell.4            45.5819917580444                      8179
## 16cell.5            46.3653553287489                      7291
##          log10_total_features_endogenous total_counts_endogenous
##                                &lt;numeric&gt;               &lt;integer&gt;
## 16cell                  3.89669152656288                 8825980
## 16cell.1                3.88490859416261                 7714601
## 16cell.2                3.90379514274104                 8074971
## 16cell.3                3.90205731080847                 6334456
## 16cell.4                3.91275330367132                 9885518
## 16cell.5                3.86284665998294                10571900
##          log10_total_counts_endogenous pct_counts_endogenous
##                              &lt;numeric&gt;             &lt;numeric&gt;
## 16cell                6.94576298819116                   100
## 16cell.1              6.88731352551746                   100
## 16cell.2              6.90714102508777                   100
## 16cell.3               6.8017093923827                   100
## 16cell.4              6.99499947515896                   100
## 16cell.5              7.02415308755133                   100
##          pct_counts_top_50_features_endogenous
##                                      &lt;numeric&gt;
## 16cell                        16.1419581734833
## 16cell.1                      14.3400287325294
## 16cell.2                      16.2521450541432
## 16cell.3                      14.7442337589842
## 16cell.4                      14.8676680372237
## 16cell.5                      15.0683037107805
##          pct_counts_top_100_features_endogenous
##                                       &lt;numeric&gt;
## 16cell                         22.9905574225185
## 16cell.1                       20.7937779283724
## 16cell.2                       23.0008380215855
## 16cell.3                       21.3769738080113
## 16cell.4                       21.4405557705727
## 16cell.5                       21.4823636243249
##          pct_counts_top_200_features_endogenous
##                                       &lt;numeric&gt;
## 16cell                         31.9837570445435
## 16cell.1                       29.2256333153199
## 16cell.2                       32.0749387211422
## 16cell.3                       30.2242213064547
## 16cell.4                       29.9306015122323
## 16cell.5                        30.227310133467
##          pct_counts_top_500_features_endogenous total_features_feature_control
##                                       &lt;numeric&gt;                      &lt;integer&gt;
## 16cell                         47.7577107584654                              0
## 16cell.1                       44.9996701060755                              0
## 16cell.2                       47.7693356421961                              0
## 16cell.3                       46.1895070389628                              0
## 16cell.4                       45.5819917580444                              0
## 16cell.5                       46.3653553287489                              0
##          log10_total_features_feature_control total_counts_feature_control
##                                     &lt;numeric&gt;                    &lt;integer&gt;
## 16cell                                      0                            0
## 16cell.1                                    0                            0
## 16cell.2                                    0                            0
## 16cell.3                                    0                            0
## 16cell.4                                    0                            0
## 16cell.5                                    0                            0
##          log10_total_counts_feature_control pct_counts_feature_control
##                                   &lt;numeric&gt;                  &lt;numeric&gt;
## 16cell                                    0                          0
## 16cell.1                                  0                          0
## 16cell.2                                  0                          0
## 16cell.3                                  0                          0
## 16cell.4                                  0                          0
## 16cell.5                                  0                          0
##          total_features_ERCC log10_total_features_ERCC total_counts_ERCC
##                    &lt;integer&gt;                 &lt;numeric&gt;         &lt;integer&gt;
## 16cell                     0                         0                 0
## 16cell.1                   0                         0                 0
## 16cell.2                   0                         0                 0
## 16cell.3                   0                         0                 0
## 16cell.4                   0                         0                 0
## 16cell.5                   0                         0                 0
##          log10_total_counts_ERCC pct_counts_ERCC is_cell_control
##                        &lt;numeric&gt;       &lt;numeric&gt;       &lt;logical&gt;
## 16cell                         0               0           FALSE
## 16cell.1                       0               0           FALSE
## 16cell.2                       0               0           FALSE
## 16cell.3                       0               0           FALSE
## 16cell.4                       0               0           FALSE
## 16cell.5                       0               0           FALSE
##                       PC1               PC2
##                 &lt;numeric&gt;         &lt;numeric&gt;
## 16cell   24.7986820262447 -62.2082648676066
## 16cell.1 28.7712069014198 -50.3597388047316
## 16cell.2 26.6790073144958 -61.0387480545727
## 16cell.3 29.0115120743145 -56.0361975940189
## 16cell.4 26.3802550037036 -58.0926458026471
## 16cell.5 24.9056588611302 -60.7789654488048</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" data-line-number="1"><span class="co"># Plot PC biplot with cells colored by cell_type2. </span></a>
<a class="sourceLine" id="cb573-2" data-line-number="2"><span class="co"># colData(deng_SCE) accesses the cell metadata DataFrame object for deng_SCE.</span></a>
<a class="sourceLine" id="cb573-3" data-line-number="3"><span class="co"># Look at Figure 1A of the paper as a comparison to your PC biplot.</span></a>
<a class="sourceLine" id="cb573-4" data-line-number="4"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), <span class="kw">aes</span>(<span class="dt">x =</span> PC1, <span class="dt">y =</span> PC2, <span class="dt">color =</span> cell_type2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb573-5" data-line-number="5"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb573-6" data-line-number="6"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;PC1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;PC2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;PC biplot&quot;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/pca_pseudotime-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" data-line-number="1"><span class="co"># PCA is a simple approach and can be good to compare to more complex algorithms </span></a>
<a class="sourceLine" id="cb574-2" data-line-number="2"><span class="co"># designed to capture differentiation processes. As a simple measure of pseudotime </span></a>
<a class="sourceLine" id="cb574-3" data-line-number="3"><span class="co"># we can use the coordinates of PC1.</span></a>
<a class="sourceLine" id="cb574-4" data-line-number="4"><span class="co"># Plot PC1 vs cell_type2. </span></a>
<a class="sourceLine" id="cb574-5" data-line-number="5">deng_SCE<span class="op">$</span>pseudotime_PC1 &lt;-<span class="st"> </span><span class="kw">rank</span>(deng_SCE<span class="op">$</span>PC1)  <span class="co"># rank cells by their PC1 score</span></a>
<a class="sourceLine" id="cb574-6" data-line-number="6"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), <span class="kw">aes</span>(<span class="dt">x =</span> pseudotime_PC1, <span class="dt">y =</span> cell_type2, </a>
<a class="sourceLine" id="cb574-7" data-line-number="7">                                             <span class="dt">colour =</span> cell_type2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb574-8" data-line-number="8"><span class="st">    </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb574-9" data-line-number="9"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb574-10" data-line-number="10"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;PC1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Timepoint&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb574-11" data-line-number="11"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cells ordered by first principal component&quot;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/pca_pseudotime-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb575-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">paste0</span>(mydir, <span class="st">&quot;/pseudotime_PC1.png&quot;</span>))</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb577-1" data-line-number="1"><span class="co"># Try separating the cell types using other PCs. How does the separation look?</span></a>
<a class="sourceLine" id="cb577-2" data-line-number="2">deng_SCE<span class="op">$</span>PC5 &lt;-<span class="st"> </span>pca[, <span class="dv">5</span>]</a>
<a class="sourceLine" id="cb577-3" data-line-number="3">deng_SCE<span class="op">$</span>PC6 &lt;-<span class="st"> </span>pca[, <span class="dv">6</span>]</a>
<a class="sourceLine" id="cb577-4" data-line-number="4"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), <span class="kw">aes</span>(<span class="dt">x =</span> PC5, <span class="dt">y =</span> PC6, <span class="dt">color =</span> cell_type2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb577-5" data-line-number="5"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb577-6" data-line-number="6"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;PC5&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;PC6&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;PC biplot&quot;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/pca_pseudotime-3.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="diffusion-map-pseudotime" class="section level2">
<h2><span class="header-section-number">14.4</span> Diffusion map pseudotime</h2>
<p>Let us see how a more advance trajectory inference method, diffusion maps and diffusion pseudotime, performs at placing cells along the expected differentiation trajectory.</p>
<p><a href="https://en.wikipedia.org/wiki/Diffusion_map">Diffusion maps</a> were introduced by <a href="http://www.sciencedirect.com/science/article/pii/S1063520306000546">Ronald Coifman and Stephane Lafon</a>, and the underlying idea is to assume that the data are samples from a diffusion process. The method infers the low-dimensional manifold by estimating the eigenvalues and eigenvectors for the diffusion operator related to the data.</p>
<p><a href="https://academic.oup.com/bioinformatics/article/32/8/1241/1744143">Angerer et al</a> have applied the diffusion maps concept to the analysis of single-cell RNA-seq data to create an R package called <a href="http://bioconductor.org/packages/destiny">destiny</a>.</p>
<p>We will use two forms of pseudotime: the first diffusion component and the diffusion pseudotime.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb578-1" data-line-number="1"><span class="co">#  Prepare a counts matrix with labeled rows and columns. </span></a>
<a class="sourceLine" id="cb578-2" data-line-number="2">deng &lt;-<span class="st"> </span><span class="kw">logcounts</span>(deng_SCE)  <span class="co"># access log-transformed counts matrix</span></a>
<a class="sourceLine" id="cb578-3" data-line-number="3">cellLabels &lt;-<span class="st"> </span>deng_SCE<span class="op">$</span>cell_type2</a>
<a class="sourceLine" id="cb578-4" data-line-number="4"><span class="kw">colnames</span>(deng) &lt;-<span class="st"> </span>cellLabels</a>
<a class="sourceLine" id="cb578-5" data-line-number="5"></a>
<a class="sourceLine" id="cb578-6" data-line-number="6"><span class="co"># Make a diffusion map.</span></a>
<a class="sourceLine" id="cb578-7" data-line-number="7">dm &lt;-<span class="st"> </span><span class="kw">DiffusionMap</span>(<span class="kw">t</span>(deng))</a></code></pre></div>
<pre><code>## Warning in DiffusionMap(t(deng)): You have 22431 genes. Consider passing e.g.
## n_pcs = 50 to speed up computation.</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb580-1" data-line-number="1"><span class="co"># Optional: Try different sigma values when making diffusion map.</span></a>
<a class="sourceLine" id="cb580-2" data-line-number="2"><span class="co"># dm &lt;- DiffusionMap(t(deng), sigma = &quot;local&quot;)  # use local option to set sigma</span></a>
<a class="sourceLine" id="cb580-3" data-line-number="3"><span class="co"># sigmas &lt;- find_sigmas(t(deng), verbose = FALSE)  # find optimal sigma</span></a>
<a class="sourceLine" id="cb580-4" data-line-number="4"><span class="co"># dm &lt;- DiffusionMap(t(deng), sigma = optimal_sigma(sigmas))  </span></a>
<a class="sourceLine" id="cb580-5" data-line-number="5"></a>
<a class="sourceLine" id="cb580-6" data-line-number="6"><span class="co"># Plot diffusion component 1 vs diffusion component 2 (DC1 vs DC2). </span></a>
<a class="sourceLine" id="cb580-7" data-line-number="7">tmp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">DC1 =</span> <span class="kw">eigenvectors</span>(dm)[, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb580-8" data-line-number="8">                  <span class="dt">DC2 =</span> <span class="kw">eigenvectors</span>(dm)[, <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb580-9" data-line-number="9">                  <span class="dt">Timepoint =</span> cellLabels)</a>
<a class="sourceLine" id="cb580-10" data-line-number="10"><span class="kw">ggplot</span>(tmp, <span class="kw">aes</span>(<span class="dt">x =</span> DC1, <span class="dt">y =</span> DC2, <span class="dt">colour =</span> Timepoint)) <span class="op">+</span></a>
<a class="sourceLine" id="cb580-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb580-12" data-line-number="12"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Diffusion component 1&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb580-13" data-line-number="13"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Diffusion component 2&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb580-14" data-line-number="14"><span class="st">    </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/diffusion_pseudotime-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb581-1" data-line-number="1"><span class="co"># Try plotting higher diffusion components against one another.</span></a>
<a class="sourceLine" id="cb581-2" data-line-number="2">tmp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">DC3 =</span> <span class="kw">eigenvectors</span>(dm)[, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb581-3" data-line-number="3">                  <span class="dt">DC4 =</span> <span class="kw">eigenvectors</span>(dm)[, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb581-4" data-line-number="4">                  <span class="dt">Timepoint =</span> cellLabels)</a>
<a class="sourceLine" id="cb581-5" data-line-number="5"><span class="kw">ggplot</span>(tmp, <span class="kw">aes</span>(<span class="dt">x =</span> DC3, <span class="dt">y =</span> DC4, <span class="dt">colour =</span> Timepoint)) <span class="op">+</span></a>
<a class="sourceLine" id="cb581-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="co">#scale_color_tableau() + </span></a>
<a class="sourceLine" id="cb581-7" data-line-number="7"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Diffusion component 3&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb581-8" data-line-number="8"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Diffusion component 4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb581-9" data-line-number="9"><span class="st">    </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/diffusion_pseudotime-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb582-1" data-line-number="1"><span class="co"># Next, let us use the first diffusion component (DC1) as a measure of pseudotime.</span></a>
<a class="sourceLine" id="cb582-2" data-line-number="2"><span class="co"># How does the separation by cell stage look?</span></a>
<a class="sourceLine" id="cb582-3" data-line-number="3">deng_SCE<span class="op">$</span>pseudotime_diffusionmap &lt;-<span class="st"> </span><span class="kw">rank</span>(<span class="kw">eigenvectors</span>(dm)[,<span class="dv">1</span>])    <span class="co"># rank cells by their dpt</span></a>
<a class="sourceLine" id="cb582-4" data-line-number="4"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), </a>
<a class="sourceLine" id="cb582-5" data-line-number="5">       <span class="kw">aes</span>(<span class="dt">x =</span> pseudotime_diffusionmap, </a>
<a class="sourceLine" id="cb582-6" data-line-number="6">           <span class="dt">y =</span> cell_type2, <span class="dt">colour =</span> cell_type2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb582-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb582-8" data-line-number="8"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb582-9" data-line-number="9"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Diffusion component 1 (DC1)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Timepoint&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb582-10" data-line-number="10"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cells ordered by DC1&quot;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/diffusion_pseudotime-3.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb583-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">paste0</span>(mydir, <span class="st">&quot;/pseudotime_DC1.png&quot;</span>))</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb585-1" data-line-number="1"><span class="co"># Plot eigenvalues of diffusion distance matrix. How many diffusion components would you use?</span></a>
<a class="sourceLine" id="cb585-2" data-line-number="2"><span class="co"># This is analagous to the PC elbow plot (scree plot) that we previously used to assess how </span></a>
<a class="sourceLine" id="cb585-3" data-line-number="3"><span class="co"># many PCs to use in downstream applications like clustering.</span></a>
<a class="sourceLine" id="cb585-4" data-line-number="4"><span class="kw">plot</span>(<span class="kw">eigenvalues</span>(dm), <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">xlab =</span> <span class="st">&#39;Diffusion component (DC)&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Eigenvalue&#39;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/diffusion_pseudotime-4.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb586-1" data-line-number="1"><span class="co"># What happens if you run the diffusion map on the PCs? Why would one do this?</span></a>
<a class="sourceLine" id="cb586-2" data-line-number="2"><span class="kw">rownames</span>(pca) &lt;-<span class="st"> </span>cellLabels</a>
<a class="sourceLine" id="cb586-3" data-line-number="3">dm &lt;-<span class="st"> </span><span class="kw">DiffusionMap</span>(pca)</a>
<a class="sourceLine" id="cb586-4" data-line-number="4"></a>
<a class="sourceLine" id="cb586-5" data-line-number="5"><span class="co"># Diffusion pseudotime calculation. </span></a>
<a class="sourceLine" id="cb586-6" data-line-number="6"><span class="co"># Set index or tip of pseudotime calculation to be a zygotic cell (cell 268). </span></a>
<a class="sourceLine" id="cb586-7" data-line-number="7">dpt &lt;-<span class="st"> </span><span class="kw">DPT</span>(dm, <span class="dt">tips =</span> <span class="dv">268</span>)</a>
<a class="sourceLine" id="cb586-8" data-line-number="8"></a>
<a class="sourceLine" id="cb586-9" data-line-number="9"><span class="co"># Plot DC1 vs DC2 and color the cells by their inferred diffusion pseudotime.</span></a>
<a class="sourceLine" id="cb586-10" data-line-number="10"><span class="co"># We can accesss diffusion pseudotime via dpt$dpt.</span></a>
<a class="sourceLine" id="cb586-11" data-line-number="11">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">DC1 =</span> <span class="kw">eigenvectors</span>(dm)[, <span class="dv">1</span>], <span class="dt">DC2 =</span> <span class="kw">eigenvectors</span>(dm)[, <span class="dv">2</span>], </a>
<a class="sourceLine" id="cb586-12" data-line-number="12">                 <span class="dt">dptval =</span> dpt<span class="op">$</span>dpt, <span class="dt">cell_type2 =</span> cellLabels)</a>
<a class="sourceLine" id="cb586-13" data-line-number="13">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DC1, <span class="dt">y =</span> DC2, <span class="dt">color =</span> dptval))</a>
<a class="sourceLine" id="cb586-14" data-line-number="14">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DC1, <span class="dt">y =</span> DC2, <span class="dt">color =</span> cell_type2))</a>
<a class="sourceLine" id="cb586-15" data-line-number="15">p &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(p1, p2)</a>
<a class="sourceLine" id="cb586-16" data-line-number="16">p</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/diffusion_pseudotime-5.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb587-1" data-line-number="1"><span class="kw">save_plot</span>(<span class="kw">paste0</span>(mydir, <span class="st">&quot;/dpt_celltype.png&quot;</span>), p, <span class="dt">base_height =</span> <span class="dv">5</span>, <span class="dt">base_aspect_ratio =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb587-2" data-line-number="2"></a>
<a class="sourceLine" id="cb587-3" data-line-number="3"><span class="co"># Plot diffusion pseudotime vs timepoint. </span></a>
<a class="sourceLine" id="cb587-4" data-line-number="4"><span class="co"># Which separates the data better, DC1 or diffusion pseudotime?</span></a>
<a class="sourceLine" id="cb587-5" data-line-number="5">deng_SCE<span class="op">$</span>pseudotime_dpt &lt;-<span class="st"> </span><span class="kw">rank</span>(dpt<span class="op">$</span>dpt) </a>
<a class="sourceLine" id="cb587-6" data-line-number="6"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), </a>
<a class="sourceLine" id="cb587-7" data-line-number="7">       <span class="kw">aes</span>(<span class="dt">x =</span> pseudotime_dpt, </a>
<a class="sourceLine" id="cb587-8" data-line-number="8">           <span class="dt">y =</span> cell_type2, <span class="dt">colour =</span> cell_type2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb587-9" data-line-number="9"><span class="st">    </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb587-10" data-line-number="10"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb587-11" data-line-number="11"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Diffusion map pseudotime (dpt)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb587-12" data-line-number="12"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Timepoint&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb587-13" data-line-number="13"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cells ordered by diffusion map pseudotime&quot;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/diffusion_pseudotime-6.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb588-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">paste0</span>(mydir, <span class="st">&quot;/pseudotime_dpt.png&quot;</span>))</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb590-1" data-line-number="1"><span class="co"># Save current progress.</span></a>
<a class="sourceLine" id="cb590-2" data-line-number="2"><span class="kw">save</span>(deng_SCE, <span class="dt">file =</span> Rda.destiny.path)</a>
<a class="sourceLine" id="cb590-3" data-line-number="3"><span class="co"># To load the data, run the following command.</span></a>
<a class="sourceLine" id="cb590-4" data-line-number="4"><span class="co"># load(Rda.destiny.path)</span></a></code></pre></div>
</div>
<div id="slingshot-map-pseudotime" class="section level2">
<h2><span class="header-section-number">14.5</span> Slingshot map pseudotime</h2>
<p>Let us see how another advance trajectory inference method, Slingshot, performs at placing cells along the expected differentiation trajectory.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb591-1" data-line-number="1"><span class="kw">library</span>(slingshot)</a></code></pre></div>
<pre><code>## Loading required package: princurve</code></pre>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb593-1" data-line-number="1"><span class="kw">library</span>(Seurat)</a>
<a class="sourceLine" id="cb593-2" data-line-number="2"></a>
<a class="sourceLine" id="cb593-3" data-line-number="3"><span class="co"># load(Rda.destiny.path)</span></a>
<a class="sourceLine" id="cb593-4" data-line-number="4"></a>
<a class="sourceLine" id="cb593-5" data-line-number="5"><span class="co"># Read the Slingshot documentation (?slingshot) and then run Slingshot below. </span></a>
<a class="sourceLine" id="cb593-6" data-line-number="6"><span class="co"># Given your understanding of the algorithm and the documentation, what is one </span></a>
<a class="sourceLine" id="cb593-7" data-line-number="7"><span class="co"># major set of parameters we omitted here when running Slingshot?</span></a>
<a class="sourceLine" id="cb593-8" data-line-number="8">sce &lt;-<span class="st"> </span><span class="kw">slingshot</span>(deng_SCE, <span class="dt">reducedDim =</span> <span class="st">&#39;PCA&#39;</span>)  <span class="co"># no clusters</span></a></code></pre></div>
<pre><code>## No cluster labels provided. Continuing with one cluster.</code></pre>
<pre><code>## Using full covariance matrix</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" data-line-number="1"><span class="co"># Plot PC1 vs PC2 colored by Slingshot pseudotime.</span></a>
<a class="sourceLine" id="cb596-2" data-line-number="2">colors &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dv">50</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb596-3" data-line-number="3"><span class="kw">plot</span>(<span class="kw">reducedDims</span>(sce)<span class="op">$</span>PCA, <span class="dt">col =</span> colors[<span class="kw">cut</span>(sce<span class="op">$</span>slingPseudotime_<span class="dv">1</span>,<span class="dt">breaks=</span><span class="dv">50</span>)], <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb596-4" data-line-number="4"><span class="kw">lines</span>(<span class="kw">SlingshotDataSet</span>(sce), <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/slingshot-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb597-1" data-line-number="1"><span class="co"># Plot Slingshot pseudotime vs cell stage. </span></a>
<a class="sourceLine" id="cb597-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), <span class="kw">aes</span>(<span class="dt">x =</span> sce<span class="op">$</span>slingPseudotime_<span class="dv">1</span>, <span class="dt">y =</span> cell_type2, </a>
<a class="sourceLine" id="cb597-3" data-line-number="3">                              <span class="dt">colour =</span> cell_type2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb597-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb597-5" data-line-number="5"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb597-6" data-line-number="6"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Slingshot pseudotime&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Timepoint&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb597-7" data-line-number="7"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cells ordered by Slingshot pseudotime&quot;</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/slingshot-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb598-1" data-line-number="1"><span class="co"># Cluster cells using the Seurat workflow below.</span></a>
<a class="sourceLine" id="cb598-2" data-line-number="2">gcdata &lt;-<span class="st"> </span><span class="kw">CreateSeuratObject</span>(<span class="dt">counts =</span> <span class="kw">counts</span>(deng_SCE), <span class="dt">project =</span> <span class="st">&quot;slingshot&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Feature names cannot have pipe characters (&#39;|&#39;), replacing with dashes
## (&#39;-&#39;)</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb600-1" data-line-number="1">gcdata &lt;-<span class="st"> </span><span class="kw">NormalizeData</span>(gcdata, <span class="dt">normalization.method =</span> <span class="st">&quot;LogNormalize&quot;</span>, <span class="dt">scale.factor =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb600-2" data-line-number="2">gcdata &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(gcdata, <span class="dt">selection.method =</span> <span class="st">&quot;vst&quot;</span>, <span class="dt">nfeatures =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb600-3" data-line-number="3">gcdata &lt;-<span class="st"> </span><span class="kw">ScaleData</span>(<span class="dt">object =</span> gcdata, <span class="dt">do.center =</span> T, <span class="dt">do.scale =</span> F)</a></code></pre></div>
<pre><code>## Centering data matrix</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb602-1" data-line-number="1">gcdata &lt;-<span class="st"> </span><span class="kw">RunPCA</span>(gcdata, <span class="dt">features =</span> <span class="kw">VariableFeatures</span>(gcdata), <span class="dt">npcs =</span> <span class="dv">40</span>, <span class="dt">ndims.print =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">nfeatures.print =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## PC_ 1 
## Positive:  Actb, Fabp3, Psap, Akr1b8, Krt18 
## Negative:  Zbed3, C86187, Klf17, Btg4, Ccdc6 
## PC_ 2 
## Positive:  Krt18, Id2, Akr1b8, BC053393, Fabp3 
## Negative:  Gm11517, Alppl2, Obox6, Pdxk, Trim43b 
## PC_ 3 
## Positive:  Id2, Krt18, Tspan8, BC053393, Krt8 
## Negative:  Gm11517, Alppl2, Ypel5, Pdxk, Fam46c 
## PC_ 4 
## Positive:  Alppl2, Dab2, Gm11517, Krt18, Tspan8 
## Negative:  Upp1, Tdgf1, Spp1, Zfp57, Tat 
## PC_ 5 
## Positive:  Klf17, Ddx24, Bod1l, Tor1b, Gm1995 
## Negative:  Alppl2, Gm4340, Gm11756, Gm8300, Gm5039</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" data-line-number="1"><span class="co"># Cluster the cells using the first twenty principal components.</span></a>
<a class="sourceLine" id="cb604-2" data-line-number="2">gcdata &lt;-<span class="st"> </span><span class="kw">FindNeighbors</span>(gcdata, <span class="dt">reduction =</span> <span class="st">&quot;pca&quot;</span>, <span class="dt">dims =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">k.param =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## Computing nearest neighbor graph</code></pre>
<pre><code>## Computing SNN</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb607-1" data-line-number="1">gcdata &lt;-<span class="st"> </span><span class="kw">FindClusters</span>(gcdata, <span class="dt">resolution =</span> <span class="fl">0.6</span>, <span class="dt">algorithm =</span> <span class="dv">1</span>, <span class="dt">random.seed =</span> <span class="dv">100</span>)</a></code></pre></div>
<pre><code>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck
## 
## Number of nodes: 268
## Number of edges: 6804
## 
## Running Louvain algorithm...
## Maximum modularity in 10 random starts: 0.8081
## Number of communities: 5
## Elapsed time: 0 seconds</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb609-1" data-line-number="1"><span class="co"># Add clustering information from Seurat to the deng_SCE object</span></a>
<a class="sourceLine" id="cb609-2" data-line-number="2">deng_SCE<span class="op">$</span>slingPseudotime_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="ot">NULL</span>  <span class="co"># remove old slingshot pseudotime data</span></a>
<a class="sourceLine" id="cb609-3" data-line-number="3"><span class="kw">colData</span>(deng_SCE)<span class="op">$</span>Seurat_clusters &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">Idents</span>(gcdata))  <span class="co"># go from factor to character</span></a>
<a class="sourceLine" id="cb609-4" data-line-number="4"><span class="kw">head</span>(<span class="kw">colData</span>(deng_SCE))</a></code></pre></div>
<pre><code>## DataFrame with 6 rows and 38 columns
##          cell_type2  cell_type1 total_features log10_total_features
##            &lt;factor&gt; &lt;character&gt;      &lt;integer&gt;            &lt;numeric&gt;
## 16cell       16cell      16cell           7882     3.89669152656288
## 16cell.1     16cell      16cell           7671     3.88490859416261
## 16cell.2     16cell      16cell           8012     3.90379514274104
## 16cell.3     16cell      16cell           7980     3.90205731080847
## 16cell.4     16cell      16cell           8179     3.91275330367132
## 16cell.5     16cell      16cell           7291     3.86284665998294
##          total_counts log10_total_counts pct_counts_top_50_features
##             &lt;integer&gt;          &lt;numeric&gt;                  &lt;numeric&gt;
## 16cell        8825980   6.94576298819116           16.1419581734833
## 16cell.1      7714601   6.88731352551746           14.3400287325294
## 16cell.2      8074971   6.90714102508777           16.2521450541432
## 16cell.3      6334456    6.8017093923827           14.7442337589842
## 16cell.4      9885518   6.99499947515896           14.8676680372237
## 16cell.5     10571900   7.02415308755133           15.0683037107805
##          pct_counts_top_100_features pct_counts_top_200_features
##                            &lt;numeric&gt;                   &lt;numeric&gt;
## 16cell              22.9905574225185            31.9837570445435
## 16cell.1            20.7937779283724            29.2256333153199
## 16cell.2            23.0008380215855            32.0749387211422
## 16cell.3            21.3769738080113            30.2242213064547
## 16cell.4            21.4405557705727            29.9306015122323
## 16cell.5            21.4823636243249             30.227310133467
##          pct_counts_top_500_features total_features_endogenous
##                            &lt;numeric&gt;                 &lt;integer&gt;
## 16cell              47.7577107584654                      7882
## 16cell.1            44.9996701060755                      7671
## 16cell.2            47.7693356421961                      8012
## 16cell.3            46.1895070389628                      7980
## 16cell.4            45.5819917580444                      8179
## 16cell.5            46.3653553287489                      7291
##          log10_total_features_endogenous total_counts_endogenous
##                                &lt;numeric&gt;               &lt;integer&gt;
## 16cell                  3.89669152656288                 8825980
## 16cell.1                3.88490859416261                 7714601
## 16cell.2                3.90379514274104                 8074971
## 16cell.3                3.90205731080847                 6334456
## 16cell.4                3.91275330367132                 9885518
## 16cell.5                3.86284665998294                10571900
##          log10_total_counts_endogenous pct_counts_endogenous
##                              &lt;numeric&gt;             &lt;numeric&gt;
## 16cell                6.94576298819116                   100
## 16cell.1              6.88731352551746                   100
## 16cell.2              6.90714102508777                   100
## 16cell.3               6.8017093923827                   100
## 16cell.4              6.99499947515896                   100
## 16cell.5              7.02415308755133                   100
##          pct_counts_top_50_features_endogenous
##                                      &lt;numeric&gt;
## 16cell                        16.1419581734833
## 16cell.1                      14.3400287325294
## 16cell.2                      16.2521450541432
## 16cell.3                      14.7442337589842
## 16cell.4                      14.8676680372237
## 16cell.5                      15.0683037107805
##          pct_counts_top_100_features_endogenous
##                                       &lt;numeric&gt;
## 16cell                         22.9905574225185
## 16cell.1                       20.7937779283724
## 16cell.2                       23.0008380215855
## 16cell.3                       21.3769738080113
## 16cell.4                       21.4405557705727
## 16cell.5                       21.4823636243249
##          pct_counts_top_200_features_endogenous
##                                       &lt;numeric&gt;
## 16cell                         31.9837570445435
## 16cell.1                       29.2256333153199
## 16cell.2                       32.0749387211422
## 16cell.3                       30.2242213064547
## 16cell.4                       29.9306015122323
## 16cell.5                        30.227310133467
##          pct_counts_top_500_features_endogenous total_features_feature_control
##                                       &lt;numeric&gt;                      &lt;integer&gt;
## 16cell                         47.7577107584654                              0
## 16cell.1                       44.9996701060755                              0
## 16cell.2                       47.7693356421961                              0
## 16cell.3                       46.1895070389628                              0
## 16cell.4                       45.5819917580444                              0
## 16cell.5                       46.3653553287489                              0
##          log10_total_features_feature_control total_counts_feature_control
##                                     &lt;numeric&gt;                    &lt;integer&gt;
## 16cell                                      0                            0
## 16cell.1                                    0                            0
## 16cell.2                                    0                            0
## 16cell.3                                    0                            0
## 16cell.4                                    0                            0
## 16cell.5                                    0                            0
##          log10_total_counts_feature_control pct_counts_feature_control
##                                   &lt;numeric&gt;                  &lt;numeric&gt;
## 16cell                                    0                          0
## 16cell.1                                  0                          0
## 16cell.2                                  0                          0
## 16cell.3                                  0                          0
## 16cell.4                                  0                          0
## 16cell.5                                  0                          0
##          total_features_ERCC log10_total_features_ERCC total_counts_ERCC
##                    &lt;integer&gt;                 &lt;numeric&gt;         &lt;integer&gt;
## 16cell                     0                         0                 0
## 16cell.1                   0                         0                 0
## 16cell.2                   0                         0                 0
## 16cell.3                   0                         0                 0
## 16cell.4                   0                         0                 0
## 16cell.5                   0                         0                 0
##          log10_total_counts_ERCC pct_counts_ERCC is_cell_control
##                        &lt;numeric&gt;       &lt;numeric&gt;       &lt;logical&gt;
## 16cell                         0               0           FALSE
## 16cell.1                       0               0           FALSE
## 16cell.2                       0               0           FALSE
## 16cell.3                       0               0           FALSE
## 16cell.4                       0               0           FALSE
## 16cell.5                       0               0           FALSE
##                       PC1               PC2 pseudotime_PC1               PC5
##                 &lt;numeric&gt;         &lt;numeric&gt;      &lt;numeric&gt;         &lt;numeric&gt;
## 16cell   24.7986820262447 -62.2082648676066            171  2.12973902514438
## 16cell.1 28.7712069014198 -50.3597388047316            181 0.945418456955433
## 16cell.2 26.6790073144958 -61.0387480545727            176 -1.07750020611762
## 16cell.3 29.0115120743145 -56.0361975940189            183 -4.28850833105763
## 16cell.4 26.3802550037036 -58.0926458026471            175  9.80774159539532
## 16cell.5 24.9056588611302 -60.7789654488048            172  9.88355269770382
##                         PC6 pseudotime_diffusionmap pseudotime_dpt
##                   &lt;numeric&gt;               &lt;numeric&gt;      &lt;numeric&gt;
## 16cell     14.0930954146809                     123             88
## 16cell.1   3.59878801496069                     182             68
## 16cell.2   11.8876579313426                     122            122
## 16cell.3 -0.148850434153179                     173             74
## 16cell.4   2.05700416962238                     128            102
## 16cell.5   11.9028394497909                     144             63
##          Seurat_clusters
##              &lt;character&gt;
## 16cell                 0
## 16cell.1               0
## 16cell.2               0
## 16cell.3               0
## 16cell.4               0
## 16cell.5               0</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" data-line-number="1"><span class="co"># Then run Slingshot using these cluster assignments.</span></a>
<a class="sourceLine" id="cb611-2" data-line-number="2">deng_SCE &lt;-<span class="st"> </span><span class="kw">slingshot</span>(deng_SCE, <span class="dt">clusterLabels =</span> <span class="st">&#39;Seurat_clusters&#39;</span>, <span class="dt">reducedDim =</span> <span class="st">&#39;PCA&#39;</span>)</a></code></pre></div>
<pre><code>## Using diagonal covariance matrix</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" data-line-number="1"><span class="co"># Plot PC1 vs PC2 colored by Slingshot pseudotime.</span></a>
<a class="sourceLine" id="cb613-2" data-line-number="2">colors &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dv">50</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb613-3" data-line-number="3"><span class="kw">plot</span>(<span class="kw">reducedDims</span>(deng_SCE)<span class="op">$</span>PCA, <span class="dt">col =</span> colors[<span class="kw">cut</span>(deng_SCE<span class="op">$</span>slingPseudotime_<span class="dv">1</span>,<span class="dt">breaks=</span><span class="dv">50</span>)], <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb613-4" data-line-number="4"><span class="kw">lines</span>(<span class="kw">SlingshotDataSet</span>(deng_SCE), <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/slingshot-3.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" data-line-number="1"><span class="co"># Plot Slingshot pseudotime vs cell stage. </span></a>
<a class="sourceLine" id="cb614-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)), <span class="kw">aes</span>(<span class="dt">x =</span> slingPseudotime_<span class="dv">1</span>, <span class="dt">y =</span> cell_type2, </a>
<a class="sourceLine" id="cb614-3" data-line-number="3">                              <span class="dt">colour =</span> cell_type2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb614-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_quasirandom</span>(<span class="dt">groupOnX =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb614-5" data-line-number="5"><span class="st">    </span><span class="kw">scale_color_tableau</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb614-6" data-line-number="6"><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Slingshot pseudotime&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Timepoint&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb614-7" data-line-number="7"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cells ordered by Slingshot pseudotime&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 24 rows containing missing values (position_quasirandom).</code></pre>
<p><img src="2020_scWorkshop_files/figure-html/slingshot-4.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">paste0</span>(mydir, <span class="st">&quot;/pseudotime_slingshot.png&quot;</span>))</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<pre><code>## Warning: Removed 24 rows containing missing values (position_quasirandom).</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" data-line-number="1"><span class="co"># Save current progress.</span></a>
<a class="sourceLine" id="cb619-2" data-line-number="2"><span class="kw">save</span>(deng_SCE, <span class="dt">file =</span> Rda.slingshot.path)</a>
<a class="sourceLine" id="cb619-3" data-line-number="3"><span class="co"># To load the data, run the following command.</span></a>
<a class="sourceLine" id="cb619-4" data-line-number="4"><span class="co"># load(Rda.slingshot.path)</span></a></code></pre></div>
</div>
<div id="find-temporally-expressed-genes" class="section level2">
<h2><span class="header-section-number">14.6</span> Find temporally expressed genes</h2>
<p>In this final analysis code chunk, we will identify temporally expressed genes, ie those genes whose expression is changing in a continuous manner over pseudotime. To do this, we will fit a GAM with a LOESS term for pseudotime. Functions for fitting and working with generalized additive models, as described in “Generalized Additive Models” (Hastie and Tibshirani, 1990).
<a href="https://multithreaded.stitchfix.com/blog/2015/07/30/gam/">Read more about GAMs</a></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" data-line-number="1"><span class="co"># Only look at the 1,000 most variable genes when identifying temporally expressesd genes.</span></a>
<a class="sourceLine" id="cb620-2" data-line-number="2"><span class="co"># Identify the variable genes by ranking all genes by their variance.</span></a>
<a class="sourceLine" id="cb620-3" data-line-number="3">Y &lt;-<span class="st"> </span><span class="kw">log2</span>(<span class="kw">counts</span>(deng_SCE) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb620-4" data-line-number="4">var1K &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">sort</span>(<span class="kw">apply</span>(Y, <span class="dv">1</span>, var), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>]</a>
<a class="sourceLine" id="cb620-5" data-line-number="5">Y &lt;-<span class="st"> </span>Y[var1K, ]  <span class="co"># only counts for variable genes</span></a>
<a class="sourceLine" id="cb620-6" data-line-number="6"></a>
<a class="sourceLine" id="cb620-7" data-line-number="7"><span class="co"># Fit GAM for each gene using pseudotime as independent variable.</span></a>
<a class="sourceLine" id="cb620-8" data-line-number="8">t &lt;-<span class="st"> </span>deng_SCE<span class="op">$</span>slingPseudotime_<span class="dv">1</span></a>
<a class="sourceLine" id="cb620-9" data-line-number="9">gam.pval &lt;-<span class="st"> </span><span class="kw">apply</span>(Y, <span class="dv">1</span>, <span class="cf">function</span>(z){</a>
<a class="sourceLine" id="cb620-10" data-line-number="10">  d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">z=</span>z, <span class="dt">t=</span>t)</a>
<a class="sourceLine" id="cb620-11" data-line-number="11">  tmp &lt;-<span class="st"> </span><span class="kw">gam</span>(z <span class="op">~</span><span class="st"> </span><span class="kw">lo</span>(t), <span class="dt">data=</span>d)</a>
<a class="sourceLine" id="cb620-12" data-line-number="12">  p &lt;-<span class="st"> </span><span class="kw">summary</span>(tmp)[<span class="dv">4</span>][[<span class="dv">1</span>]][<span class="dv">1</span>,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb620-13" data-line-number="13">  p</a>
<a class="sourceLine" id="cb620-14" data-line-number="14">})</a></code></pre></div>
<pre><code>## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored

## Warning in model.matrix.default(mt, mf, contrasts): non-list contrasts argument
## ignored</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" data-line-number="1"><span class="co"># Identify genes with the most significant time-dependent model fit.</span></a>
<a class="sourceLine" id="cb622-2" data-line-number="2">topgenes &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">sort</span>(gam.pval, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]  </a>
<a class="sourceLine" id="cb622-3" data-line-number="3"></a>
<a class="sourceLine" id="cb622-4" data-line-number="4"><span class="co"># Prepare and plot a heatmap of the top genes that vary their expression over pseudotime.</span></a>
<a class="sourceLine" id="cb622-5" data-line-number="5"><span class="kw">require</span>(clusterExperiment)</a>
<a class="sourceLine" id="cb622-6" data-line-number="6">heatdata &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(gcdata[[<span class="st">&#39;RNA&#39;</span>]]<span class="op">@</span>data[<span class="kw">rownames</span>(gcdata) <span class="op">%in%</span><span class="st"> </span>topgenes, <span class="kw">order</span>(t, <span class="dt">na.last =</span> <span class="ot">NA</span>)])</a>
<a class="sourceLine" id="cb622-7" data-line-number="7">heatclus &lt;-<span class="st"> </span><span class="kw">Idents</span>(gcdata)[<span class="kw">order</span>(t, <span class="dt">na.last =</span> <span class="ot">NA</span>)]</a>
<a class="sourceLine" id="cb622-8" data-line-number="8"><span class="kw">png</span>(<span class="kw">paste0</span>(mydir, <span class="st">&quot;heatmap_time_genes.png&quot;</span>), <span class="dt">width=</span><span class="dv">10</span>, <span class="dt">height=</span><span class="dv">10</span>, <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>, <span class="dt">res=</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb622-9" data-line-number="9"><span class="co"># ce &lt;- ClusterExperiment(heatdata, heatclus, transformation = log1p)</span></a>
<a class="sourceLine" id="cb622-10" data-line-number="10"><span class="co"># clusterExperiment::plotHeatmap(ce, clusterSamplesData = &quot;orderSamplesValue&quot;, visualizeData = &#39;transformed&#39;, cexRow = 1.5, fontsize = 15)</span></a>
<a class="sourceLine" id="cb622-11" data-line-number="11"><span class="kw">heatmap</span>(<span class="kw">log1p</span>(heatdata), <span class="dt">Colv =</span> <span class="ot">NA</span>, <span class="dt">ColSideColors =</span> <span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Set1&quot;</span>)[heatclus])</a>
<a class="sourceLine" id="cb622-12" data-line-number="12"><span class="kw">dev.off</span>()</a></code></pre></div>
<pre><code>## png 
##   2</code></pre>
</div>
<div id="comparison-of-the-different-trajectory-inference-methods" class="section level2">
<h2><span class="header-section-number">14.7</span> Comparison of the different trajectory inference methods</h2>
<p>How do the trajectories inferred by PCA, diffusion pseudotime, and slingshot pseudotime compare to one another?</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" data-line-number="1"><span class="co"># Prepare data frame with different pseudotime measures.</span></a>
<a class="sourceLine" id="cb624-2" data-line-number="2">df_pseudotime &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">colData</span>(deng_SCE)[, <span class="kw">c</span>(<span class="st">&quot;pseudotime_PC1&quot;</span>, <span class="st">&quot;pseudotime_dpt&quot;</span>, <span class="st">&quot;slingPseudotime_1&quot;</span>)])</a>
<a class="sourceLine" id="cb624-3" data-line-number="3"><span class="kw">colnames</span>(df_pseudotime) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;diffusion&quot;</span>, <span class="st">&quot;slingshot&quot;</span>)</a>
<a class="sourceLine" id="cb624-4" data-line-number="4"></a>
<a class="sourceLine" id="cb624-5" data-line-number="5"><span class="co"># Plot correlation between different pseudotime measures.</span></a>
<a class="sourceLine" id="cb624-6" data-line-number="6"><span class="kw">corrplot.mixed</span>(<span class="kw">cor</span>(df_pseudotime, <span class="dt">use =</span> <span class="st">&quot;na.or.complete&quot;</span>), </a>
<a class="sourceLine" id="cb624-7" data-line-number="7">               <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb624-8" data-line-number="8">               <span class="dt">main =</span> <span class="st">&quot;Correlation matrix for pseudotime results&quot;</span>,</a>
<a class="sourceLine" id="cb624-9" data-line-number="9">               <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">3.1</span>, <span class="dv">0</span>))</a></code></pre></div>
<p><img src="2020_scWorkshop_files/figure-html/compare_traj-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="plots-of-gene-expression-over-time." class="section level2">
<h2><span class="header-section-number">14.8</span> Plots of gene expression over time.</h2>
<p>Visualize how some of the temporally expressed genes change in time.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" data-line-number="1"><span class="kw">plotExpression</span>(deng_SCE, <span class="st">&quot;Obox5&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;PC1&quot;</span>, </a>
<a class="sourceLine" id="cb625-2" data-line-number="2">               <span class="dt">colour_by =</span> <span class="st">&quot;cell_type2&quot;</span>, <span class="dt">show_violin =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb625-3" data-line-number="3">               <span class="dt">show_smooth =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="2020_scWorkshop_files/figure-html/visualize_traj-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" data-line-number="1"><span class="kw">plotExpression</span>(deng_SCE, <span class="st">&quot;Obox5&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;pseudotime_dpt&quot;</span>, </a>
<a class="sourceLine" id="cb627-2" data-line-number="2">               <span class="dt">colour_by =</span> <span class="st">&quot;cell_type2&quot;</span>, <span class="dt">show_violin =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb627-3" data-line-number="3">               <span class="dt">show_smooth =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="2020_scWorkshop_files/figure-html/visualize_traj-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb629-1" data-line-number="1"><span class="kw">plotExpression</span>(deng_SCE, <span class="st">&quot;Obox5&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;slingPseudotime_1&quot;</span>, </a>
<a class="sourceLine" id="cb629-2" data-line-number="2">               <span class="dt">colour_by =</span> <span class="st">&quot;cell_type2&quot;</span>, <span class="dt">show_violin =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb629-3" data-line-number="3">               <span class="dt">show_smooth =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 24 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 24 rows containing missing values (geom_point).</code></pre>
<p><img src="2020_scWorkshop_files/figure-html/visualize_traj-3.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="acknowledgements-1" class="section level2">
<h2><span class="header-section-number">14.9</span> Acknowledgements</h2>
<p>This document builds off chapter 8.4 from the <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/biological-analysis.html">Analysis of single cell RNA-seq data</a>, from the <a href="https://bioconductor.org/packages/release/bioc/html/destiny.html">Destiny vignette</a> and from the <a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/slingshot/inst/doc/slingshot.html">Slingshot vignette</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="trajectory-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mutli-omic-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["2020_scWorkshop.pdf", "2020_scWorkshop.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
